<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Dokumentace k programov&eacute;mu vybaven&iacute;</title>
        <style>
/* From extension vscode.markdown-math */
@font-face{font-family:KaTeX_AMS;src:url(fonts/KaTeX_AMS-Regular.woff2) format("woff2"),url(fonts/KaTeX_AMS-Regular.woff) format("woff"),url(fonts/KaTeX_AMS-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Caligraphic;src:url(fonts/KaTeX_Caligraphic-Bold.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Bold.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Bold.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Caligraphic;src:url(fonts/KaTeX_Caligraphic-Regular.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Regular.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Fraktur;src:url(fonts/KaTeX_Fraktur-Bold.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Bold.woff) format("woff"),url(fonts/KaTeX_Fraktur-Bold.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Fraktur;src:url(fonts/KaTeX_Fraktur-Regular.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Regular.woff) format("woff"),url(fonts/KaTeX_Fraktur-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Main;src:url(fonts/KaTeX_Main-Bold.woff2) format("woff2"),url(fonts/KaTeX_Main-Bold.woff) format("woff"),url(fonts/KaTeX_Main-Bold.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Main;src:url(fonts/KaTeX_Main-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Main-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Main-BoldItalic.ttf) format("truetype");font-weight:700;font-style:italic}@font-face{font-family:KaTeX_Main;src:url(fonts/KaTeX_Main-Italic.woff2) format("woff2"),url(fonts/KaTeX_Main-Italic.woff) format("woff"),url(fonts/KaTeX_Main-Italic.ttf) format("truetype");font-weight:400;font-style:italic}@font-face{font-family:KaTeX_Main;src:url(fonts/KaTeX_Main-Regular.woff2) format("woff2"),url(fonts/KaTeX_Main-Regular.woff) format("woff"),url(fonts/KaTeX_Main-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Math;src:url(fonts/KaTeX_Math-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Math-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Math-BoldItalic.ttf) format("truetype");font-weight:700;font-style:italic}@font-face{font-family:KaTeX_Math;src:url(fonts/KaTeX_Math-Italic.woff2) format("woff2"),url(fonts/KaTeX_Math-Italic.woff) format("woff"),url(fonts/KaTeX_Math-Italic.ttf) format("truetype");font-weight:400;font-style:italic}@font-face{font-family:"KaTeX_SansSerif";src:url(fonts/KaTeX_SansSerif-Bold.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Bold.woff) format("woff"),url(fonts/KaTeX_SansSerif-Bold.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:"KaTeX_SansSerif";src:url(fonts/KaTeX_SansSerif-Italic.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Italic.woff) format("woff"),url(fonts/KaTeX_SansSerif-Italic.ttf) format("truetype");font-weight:400;font-style:italic}@font-face{font-family:"KaTeX_SansSerif";src:url(fonts/KaTeX_SansSerif-Regular.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Regular.woff) format("woff"),url(fonts/KaTeX_SansSerif-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Script;src:url(fonts/KaTeX_Script-Regular.woff2) format("woff2"),url(fonts/KaTeX_Script-Regular.woff) format("woff"),url(fonts/KaTeX_Script-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size1;src:url(fonts/KaTeX_Size1-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size1-Regular.woff) format("woff"),url(fonts/KaTeX_Size1-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size2;src:url(fonts/KaTeX_Size2-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size2-Regular.woff) format("woff"),url(fonts/KaTeX_Size2-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size3;src:url(fonts/KaTeX_Size3-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size3-Regular.woff) format("woff"),url(fonts/KaTeX_Size3-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size4;src:url(fonts/KaTeX_Size4-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size4-Regular.woff) format("woff"),url(fonts/KaTeX_Size4-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Typewriter;src:url(fonts/KaTeX_Typewriter-Regular.woff2) format("woff2"),url(fonts/KaTeX_Typewriter-Regular.woff) format("woff"),url(fonts/KaTeX_Typewriter-Regular.ttf) format("truetype");font-weight:400;font-style:normal}.katex{font:normal 1.21em KaTeX_Main,Times New Roman,serif;line-height:1.2;text-indent:0;text-rendering:auto;border-color:currentColor}.katex *{-ms-high-contrast-adjust:none!important}.katex .katex-version:after{content:"0.13.0"}.katex .katex-mathml{position:absolute;clip:rect(1px,1px,1px,1px);padding:0;border:0;height:1px;width:1px;overflow:hidden}.katex .katex-html>.newline{display:block}.katex .base{position:relative;white-space:nowrap;width:-webkit-min-content;width:-moz-min-content;width:min-content}.katex .base,.katex .strut{display:inline-block}.katex .textbf{font-weight:700}.katex .textit{font-style:italic}.katex .textrm{font-family:KaTeX_Main}.katex .textsf{font-family:KaTeX_SansSerif}.katex .texttt{font-family:KaTeX_Typewriter}.katex .mathnormal{font-family:KaTeX_Math;font-style:italic}.katex .mathit{font-family:KaTeX_Main;font-style:italic}.katex .mathrm{font-style:normal}.katex .mathbf{font-family:KaTeX_Main;font-weight:700}.katex .boldsymbol{font-family:KaTeX_Math;font-weight:700;font-style:italic}.katex .amsrm,.katex .mathbb,.katex .textbb{font-family:KaTeX_AMS}.katex .mathcal{font-family:KaTeX_Caligraphic}.katex .mathfrak,.katex .textfrak{font-family:KaTeX_Fraktur}.katex .mathtt{font-family:KaTeX_Typewriter}.katex .mathscr,.katex .textscr{font-family:KaTeX_Script}.katex .mathsf,.katex .textsf{font-family:KaTeX_SansSerif}.katex .mathboldsf,.katex .textboldsf{font-family:KaTeX_SansSerif;font-weight:700}.katex .mathitsf,.katex .textitsf{font-family:KaTeX_SansSerif;font-style:italic}.katex .mainrm{font-family:KaTeX_Main;font-style:normal}.katex .vlist-t{display:inline-table;table-layout:fixed;border-collapse:collapse}.katex .vlist-r{display:table-row}.katex .vlist{display:table-cell;vertical-align:bottom;position:relative}.katex .vlist>span{display:block;height:0;position:relative}.katex .vlist>span>span{display:inline-block}.katex .vlist>span>.pstrut{overflow:hidden;width:0}.katex .vlist-t2{margin-right:-2px}.katex .vlist-s{display:table-cell;vertical-align:bottom;font-size:1px;width:2px;min-width:2px}.katex .vbox{display:inline-flex;flex-direction:column;align-items:baseline}.katex .hbox{width:100%}.katex .hbox,.katex .thinbox{display:inline-flex;flex-direction:row}.katex .thinbox{width:0;max-width:0}.katex .msupsub{text-align:left}.katex .mfrac>span>span{text-align:center}.katex .mfrac .frac-line{display:inline-block;width:100%;border-bottom-style:solid}.katex .hdashline,.katex .hline,.katex .mfrac .frac-line,.katex .overline .overline-line,.katex .rule,.katex .underline .underline-line{min-height:1px}.katex .mspace{display:inline-block}.katex .clap,.katex .llap,.katex .rlap{width:0;position:relative}.katex .clap>.inner,.katex .llap>.inner,.katex .rlap>.inner{position:absolute}.katex .clap>.fix,.katex .llap>.fix,.katex .rlap>.fix{display:inline-block}.katex .llap>.inner{right:0}.katex .clap>.inner,.katex .rlap>.inner{left:0}.katex .clap>.inner>span{margin-left:-50%;margin-right:50%}.katex .rule{display:inline-block;border:0 solid;position:relative}.katex .hline,.katex .overline .overline-line,.katex .underline .underline-line{display:inline-block;width:100%;border-bottom-style:solid}.katex .hdashline{display:inline-block;width:100%;border-bottom-style:dashed}.katex .sqrt>.root{margin-left:.27777778em;margin-right:-.55555556em}.katex .fontsize-ensurer.reset-size1.size1,.katex .sizing.reset-size1.size1{font-size:1em}.katex .fontsize-ensurer.reset-size1.size2,.katex .sizing.reset-size1.size2{font-size:1.2em}.katex .fontsize-ensurer.reset-size1.size3,.katex .sizing.reset-size1.size3{font-size:1.4em}.katex .fontsize-ensurer.reset-size1.size4,.katex .sizing.reset-size1.size4{font-size:1.6em}.katex .fontsize-ensurer.reset-size1.size5,.katex .sizing.reset-size1.size5{font-size:1.8em}.katex .fontsize-ensurer.reset-size1.size6,.katex .sizing.reset-size1.size6{font-size:2em}.katex .fontsize-ensurer.reset-size1.size7,.katex .sizing.reset-size1.size7{font-size:2.4em}.katex .fontsize-ensurer.reset-size1.size8,.katex .sizing.reset-size1.size8{font-size:2.88em}.katex .fontsize-ensurer.reset-size1.size9,.katex .sizing.reset-size1.size9{font-size:3.456em}.katex .fontsize-ensurer.reset-size1.size10,.katex .sizing.reset-size1.size10{font-size:4.148em}.katex .fontsize-ensurer.reset-size1.size11,.katex .sizing.reset-size1.size11{font-size:4.976em}.katex .fontsize-ensurer.reset-size2.size1,.katex .sizing.reset-size2.size1{font-size:.83333333em}.katex .fontsize-ensurer.reset-size2.size2,.katex .sizing.reset-size2.size2{font-size:1em}.katex .fontsize-ensurer.reset-size2.size3,.katex .sizing.reset-size2.size3{font-size:1.16666667em}.katex .fontsize-ensurer.reset-size2.size4,.katex .sizing.reset-size2.size4{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size2.size5,.katex .sizing.reset-size2.size5{font-size:1.5em}.katex .fontsize-ensurer.reset-size2.size6,.katex .sizing.reset-size2.size6{font-size:1.66666667em}.katex .fontsize-ensurer.reset-size2.size7,.katex .sizing.reset-size2.size7{font-size:2em}.katex .fontsize-ensurer.reset-size2.size8,.katex .sizing.reset-size2.size8{font-size:2.4em}.katex .fontsize-ensurer.reset-size2.size9,.katex .sizing.reset-size2.size9{font-size:2.88em}.katex .fontsize-ensurer.reset-size2.size10,.katex .sizing.reset-size2.size10{font-size:3.45666667em}.katex .fontsize-ensurer.reset-size2.size11,.katex .sizing.reset-size2.size11{font-size:4.14666667em}.katex .fontsize-ensurer.reset-size3.size1,.katex .sizing.reset-size3.size1{font-size:.71428571em}.katex .fontsize-ensurer.reset-size3.size2,.katex .sizing.reset-size3.size2{font-size:.85714286em}.katex .fontsize-ensurer.reset-size3.size3,.katex .sizing.reset-size3.size3{font-size:1em}.katex .fontsize-ensurer.reset-size3.size4,.katex .sizing.reset-size3.size4{font-size:1.14285714em}.katex .fontsize-ensurer.reset-size3.size5,.katex .sizing.reset-size3.size5{font-size:1.28571429em}.katex .fontsize-ensurer.reset-size3.size6,.katex .sizing.reset-size3.size6{font-size:1.42857143em}.katex .fontsize-ensurer.reset-size3.size7,.katex .sizing.reset-size3.size7{font-size:1.71428571em}.katex .fontsize-ensurer.reset-size3.size8,.katex .sizing.reset-size3.size8{font-size:2.05714286em}.katex .fontsize-ensurer.reset-size3.size9,.katex .sizing.reset-size3.size9{font-size:2.46857143em}.katex .fontsize-ensurer.reset-size3.size10,.katex .sizing.reset-size3.size10{font-size:2.96285714em}.katex .fontsize-ensurer.reset-size3.size11,.katex .sizing.reset-size3.size11{font-size:3.55428571em}.katex .fontsize-ensurer.reset-size4.size1,.katex .sizing.reset-size4.size1{font-size:.625em}.katex .fontsize-ensurer.reset-size4.size2,.katex .sizing.reset-size4.size2{font-size:.75em}.katex .fontsize-ensurer.reset-size4.size3,.katex .sizing.reset-size4.size3{font-size:.875em}.katex .fontsize-ensurer.reset-size4.size4,.katex .sizing.reset-size4.size4{font-size:1em}.katex .fontsize-ensurer.reset-size4.size5,.katex .sizing.reset-size4.size5{font-size:1.125em}.katex .fontsize-ensurer.reset-size4.size6,.katex .sizing.reset-size4.size6{font-size:1.25em}.katex .fontsize-ensurer.reset-size4.size7,.katex .sizing.reset-size4.size7{font-size:1.5em}.katex .fontsize-ensurer.reset-size4.size8,.katex .sizing.reset-size4.size8{font-size:1.8em}.katex .fontsize-ensurer.reset-size4.size9,.katex .sizing.reset-size4.size9{font-size:2.16em}.katex .fontsize-ensurer.reset-size4.size10,.katex .sizing.reset-size4.size10{font-size:2.5925em}.katex .fontsize-ensurer.reset-size4.size11,.katex .sizing.reset-size4.size11{font-size:3.11em}.katex .fontsize-ensurer.reset-size5.size1,.katex .sizing.reset-size5.size1{font-size:.55555556em}.katex .fontsize-ensurer.reset-size5.size2,.katex .sizing.reset-size5.size2{font-size:.66666667em}.katex .fontsize-ensurer.reset-size5.size3,.katex .sizing.reset-size5.size3{font-size:.77777778em}.katex .fontsize-ensurer.reset-size5.size4,.katex .sizing.reset-size5.size4{font-size:.88888889em}.katex .fontsize-ensurer.reset-size5.size5,.katex .sizing.reset-size5.size5{font-size:1em}.katex .fontsize-ensurer.reset-size5.size6,.katex .sizing.reset-size5.size6{font-size:1.11111111em}.katex .fontsize-ensurer.reset-size5.size7,.katex .sizing.reset-size5.size7{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size5.size8,.katex .sizing.reset-size5.size8{font-size:1.6em}.katex .fontsize-ensurer.reset-size5.size9,.katex .sizing.reset-size5.size9{font-size:1.92em}.katex .fontsize-ensurer.reset-size5.size10,.katex .sizing.reset-size5.size10{font-size:2.30444444em}.katex .fontsize-ensurer.reset-size5.size11,.katex .sizing.reset-size5.size11{font-size:2.76444444em}.katex .fontsize-ensurer.reset-size6.size1,.katex .sizing.reset-size6.size1{font-size:.5em}.katex .fontsize-ensurer.reset-size6.size2,.katex .sizing.reset-size6.size2{font-size:.6em}.katex .fontsize-ensurer.reset-size6.size3,.katex .sizing.reset-size6.size3{font-size:.7em}.katex .fontsize-ensurer.reset-size6.size4,.katex .sizing.reset-size6.size4{font-size:.8em}.katex .fontsize-ensurer.reset-size6.size5,.katex .sizing.reset-size6.size5{font-size:.9em}.katex .fontsize-ensurer.reset-size6.size6,.katex .sizing.reset-size6.size6{font-size:1em}.katex .fontsize-ensurer.reset-size6.size7,.katex .sizing.reset-size6.size7{font-size:1.2em}.katex .fontsize-ensurer.reset-size6.size8,.katex .sizing.reset-size6.size8{font-size:1.44em}.katex .fontsize-ensurer.reset-size6.size9,.katex .sizing.reset-size6.size9{font-size:1.728em}.katex .fontsize-ensurer.reset-size6.size10,.katex .sizing.reset-size6.size10{font-size:2.074em}.katex .fontsize-ensurer.reset-size6.size11,.katex .sizing.reset-size6.size11{font-size:2.488em}.katex .fontsize-ensurer.reset-size7.size1,.katex .sizing.reset-size7.size1{font-size:.41666667em}.katex .fontsize-ensurer.reset-size7.size2,.katex .sizing.reset-size7.size2{font-size:.5em}.katex .fontsize-ensurer.reset-size7.size3,.katex .sizing.reset-size7.size3{font-size:.58333333em}.katex .fontsize-ensurer.reset-size7.size4,.katex .sizing.reset-size7.size4{font-size:.66666667em}.katex .fontsize-ensurer.reset-size7.size5,.katex .sizing.reset-size7.size5{font-size:.75em}.katex .fontsize-ensurer.reset-size7.size6,.katex .sizing.reset-size7.size6{font-size:.83333333em}.katex .fontsize-ensurer.reset-size7.size7,.katex .sizing.reset-size7.size7{font-size:1em}.katex .fontsize-ensurer.reset-size7.size8,.katex .sizing.reset-size7.size8{font-size:1.2em}.katex .fontsize-ensurer.reset-size7.size9,.katex .sizing.reset-size7.size9{font-size:1.44em}.katex .fontsize-ensurer.reset-size7.size10,.katex .sizing.reset-size7.size10{font-size:1.72833333em}.katex .fontsize-ensurer.reset-size7.size11,.katex .sizing.reset-size7.size11{font-size:2.07333333em}.katex .fontsize-ensurer.reset-size8.size1,.katex .sizing.reset-size8.size1{font-size:.34722222em}.katex .fontsize-ensurer.reset-size8.size2,.katex .sizing.reset-size8.size2{font-size:.41666667em}.katex .fontsize-ensurer.reset-size8.size3,.katex .sizing.reset-size8.size3{font-size:.48611111em}.katex .fontsize-ensurer.reset-size8.size4,.katex .sizing.reset-size8.size4{font-size:.55555556em}.katex .fontsize-ensurer.reset-size8.size5,.katex .sizing.reset-size8.size5{font-size:.625em}.katex .fontsize-ensurer.reset-size8.size6,.katex .sizing.reset-size8.size6{font-size:.69444444em}.katex .fontsize-ensurer.reset-size8.size7,.katex .sizing.reset-size8.size7{font-size:.83333333em}.katex .fontsize-ensurer.reset-size8.size8,.katex .sizing.reset-size8.size8{font-size:1em}.katex .fontsize-ensurer.reset-size8.size9,.katex .sizing.reset-size8.size9{font-size:1.2em}.katex .fontsize-ensurer.reset-size8.size10,.katex .sizing.reset-size8.size10{font-size:1.44027778em}.katex .fontsize-ensurer.reset-size8.size11,.katex .sizing.reset-size8.size11{font-size:1.72777778em}.katex .fontsize-ensurer.reset-size9.size1,.katex .sizing.reset-size9.size1{font-size:.28935185em}.katex .fontsize-ensurer.reset-size9.size2,.katex .sizing.reset-size9.size2{font-size:.34722222em}.katex .fontsize-ensurer.reset-size9.size3,.katex .sizing.reset-size9.size3{font-size:.40509259em}.katex .fontsize-ensurer.reset-size9.size4,.katex .sizing.reset-size9.size4{font-size:.46296296em}.katex .fontsize-ensurer.reset-size9.size5,.katex .sizing.reset-size9.size5{font-size:.52083333em}.katex .fontsize-ensurer.reset-size9.size6,.katex .sizing.reset-size9.size6{font-size:.5787037em}.katex .fontsize-ensurer.reset-size9.size7,.katex .sizing.reset-size9.size7{font-size:.69444444em}.katex .fontsize-ensurer.reset-size9.size8,.katex .sizing.reset-size9.size8{font-size:.83333333em}.katex .fontsize-ensurer.reset-size9.size9,.katex .sizing.reset-size9.size9{font-size:1em}.katex .fontsize-ensurer.reset-size9.size10,.katex .sizing.reset-size9.size10{font-size:1.20023148em}.katex .fontsize-ensurer.reset-size9.size11,.katex .sizing.reset-size9.size11{font-size:1.43981481em}.katex .fontsize-ensurer.reset-size10.size1,.katex .sizing.reset-size10.size1{font-size:.24108004em}.katex .fontsize-ensurer.reset-size10.size2,.katex .sizing.reset-size10.size2{font-size:.28929605em}.katex .fontsize-ensurer.reset-size10.size3,.katex .sizing.reset-size10.size3{font-size:.33751205em}.katex .fontsize-ensurer.reset-size10.size4,.katex .sizing.reset-size10.size4{font-size:.38572806em}.katex .fontsize-ensurer.reset-size10.size5,.katex .sizing.reset-size10.size5{font-size:.43394407em}.katex .fontsize-ensurer.reset-size10.size6,.katex .sizing.reset-size10.size6{font-size:.48216008em}.katex .fontsize-ensurer.reset-size10.size7,.katex .sizing.reset-size10.size7{font-size:.57859209em}.katex .fontsize-ensurer.reset-size10.size8,.katex .sizing.reset-size10.size8{font-size:.69431051em}.katex .fontsize-ensurer.reset-size10.size9,.katex .sizing.reset-size10.size9{font-size:.83317261em}.katex .fontsize-ensurer.reset-size10.size10,.katex .sizing.reset-size10.size10{font-size:1em}.katex .fontsize-ensurer.reset-size10.size11,.katex .sizing.reset-size10.size11{font-size:1.19961427em}.katex .fontsize-ensurer.reset-size11.size1,.katex .sizing.reset-size11.size1{font-size:.20096463em}.katex .fontsize-ensurer.reset-size11.size2,.katex .sizing.reset-size11.size2{font-size:.24115756em}.katex .fontsize-ensurer.reset-size11.size3,.katex .sizing.reset-size11.size3{font-size:.28135048em}.katex .fontsize-ensurer.reset-size11.size4,.katex .sizing.reset-size11.size4{font-size:.32154341em}.katex .fontsize-ensurer.reset-size11.size5,.katex .sizing.reset-size11.size5{font-size:.36173633em}.katex .fontsize-ensurer.reset-size11.size6,.katex .sizing.reset-size11.size6{font-size:.40192926em}.katex .fontsize-ensurer.reset-size11.size7,.katex .sizing.reset-size11.size7{font-size:.48231511em}.katex .fontsize-ensurer.reset-size11.size8,.katex .sizing.reset-size11.size8{font-size:.57877814em}.katex .fontsize-ensurer.reset-size11.size9,.katex .sizing.reset-size11.size9{font-size:.69453376em}.katex .fontsize-ensurer.reset-size11.size10,.katex .sizing.reset-size11.size10{font-size:.83360129em}.katex .fontsize-ensurer.reset-size11.size11,.katex .sizing.reset-size11.size11{font-size:1em}.katex .delimsizing.size1{font-family:KaTeX_Size1}.katex .delimsizing.size2{font-family:KaTeX_Size2}.katex .delimsizing.size3{font-family:KaTeX_Size3}.katex .delimsizing.size4{font-family:KaTeX_Size4}.katex .delimsizing.mult .delim-size1>span{font-family:KaTeX_Size1}.katex .delimsizing.mult .delim-size4>span{font-family:KaTeX_Size4}.katex .nulldelimiter{display:inline-block;width:.12em}.katex .delimcenter,.katex .op-symbol{position:relative}.katex .op-symbol.small-op{font-family:KaTeX_Size1}.katex .op-symbol.large-op{font-family:KaTeX_Size2}.katex .accent>.vlist-t,.katex .op-limits>.vlist-t{text-align:center}.katex .accent .accent-body{position:relative}.katex .accent .accent-body:not(.accent-full){width:0}.katex .overlay{display:block}.katex .mtable .vertical-separator{display:inline-block;min-width:1px}.katex .mtable .arraycolsep{display:inline-block}.katex .mtable .col-align-c>.vlist-t{text-align:center}.katex .mtable .col-align-l>.vlist-t{text-align:left}.katex .mtable .col-align-r>.vlist-t{text-align:right}.katex .svg-align{text-align:left}.katex svg{display:block;position:absolute;width:100%;height:inherit;fill:currentColor;stroke:currentColor;fill-rule:nonzero;fill-opacity:1;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1}.katex svg path{stroke:none}.katex img{border-style:none;min-width:0;min-height:0;max-width:none;max-height:none}.katex .stretchy{width:100%;display:block;position:relative;overflow:hidden}.katex .stretchy:after,.katex .stretchy:before{content:""}.katex .hide-tail{width:100%;position:relative;overflow:hidden}.katex .halfarrow-left{position:absolute;left:0;width:50.2%;overflow:hidden}.katex .halfarrow-right{position:absolute;right:0;width:50.2%;overflow:hidden}.katex .brace-left{position:absolute;left:0;width:25.1%;overflow:hidden}.katex .brace-center{position:absolute;left:25%;width:50%;overflow:hidden}.katex .brace-right{position:absolute;right:0;width:25.1%;overflow:hidden}.katex .x-arrow-pad{padding:0 .5em}.katex .cd-arrow-pad{padding:0 .55556em 0 .27778em}.katex .mover,.katex .munder,.katex .x-arrow{text-align:center}.katex .boxpad{padding:0 .3em}.katex .fbox,.katex .fcolorbox{box-sizing:border-box;border:.04em solid}.katex .cancel-pad{padding:0 .2em}.katex .cancel-lap{margin-left:-.2em;margin-right:-.2em}.katex .sout{border-bottom-style:solid;border-bottom-width:.08em}.katex .angl{box-sizing:border-content;border-top:.049em solid;border-right:.049em solid;margin-right:.03889em}.katex .anglpad{padding:0 .03889em}.katex .eqn-num:before{counter-increment:katexEqnNo;content:"(" counter(katexEqnNo) ")"}.katex .mml-eqn-num:before{counter-increment:mmlEqnNo;content:"(" counter(mmlEqnNo) ")"}.katex .mtr-glue{width:50%}.katex .cd-vert-arrow{display:inline-block;position:relative}.katex .cd-label-left{display:inline-block;position:absolute;right:calc(50% + .3em);text-align:left}.katex .cd-label-right{display:inline-block;position:absolute;left:calc(50% + .3em);text-align:right}.katex-display{display:block;margin:1em 0;text-align:center}.katex-display>.katex{display:block;text-align:center;white-space:nowrap}.katex-display>.katex>.katex-html{display:block;position:relative}.katex-display>.katex>.katex-html>.tag{position:absolute;right:0}.katex-display.leqno>.katex>.katex-html>.tag{left:0;right:auto}.katex-display.fleqn>.katex{text-align:left;padding-left:2em}body{counter-reset:katexEqnNo mmlEqnNo}

/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.katex-error {
	color: var(--vscode-editorError-foreground);
}

</style>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
        
    </head>
    <body class="vscode-body vscode-light">
        <h1 id="dokumentace-k-programovému-vybavení">Dokumentace k programovému vybavení</h1>
<h2 id="obsah">Obsah</h2>
<ul>
<li><a href="#dokumentace-k-programov%C3%A9mu-vybaven%C3%AD">Dokumentace k programovému vybavení</a>
<ul>
<li><a href="#obsah">Obsah</a></li>
<li><a href="#%C3%BAvod">Úvod</a>
<ul>
<li><a href="#%C4%8Dlen%C4%9Bn%C3%AD-dokumentace">Členění dokumentace</a></li>
<li><a href="#adres%C3%A1%C5%99ov%C3%A1-struktura">Adresářová struktura</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#1-server">1. Server</a>
<ul>
<li><a href="#11-pou%C5%BEit%C3%AD">1.1. Použití</a></li>
<li><a href="#12-skript-installsh">1.2. Skript <code>install.sh</code></a></li>
<li><a href="#13-skript-configuresh">1.3. Skript <code>configure.sh</code></a>
<ul>
<li><a href="#131-konfigura%C4%8Dn%C3%AD-soubory-influxdb-configtoml-a-grafana-grafanaini">1.3.1. Konfigurační soubory InfluxDB <code>config.toml</code> a Grafana <code>grafana.ini</code></a></li>
</ul>
</li>
<li><a href="#14-skript-removesh">1.4. Skript <code>remove.sh</code></a></li>
</ul>
</li>
<li><a href="#2-klient">2. Klient</a>
<ul>
<li><a href="#21-pou%C5%BEit%C3%AD">2.1. Použití</a>
<ul>
<li><a href="#211-konfigura%C4%8Dn%C3%AD-soubor">2.1.1. Konfigurační soubor</a></li>
<li><a href="#212-spu%C5%A1t%C4%9Bn%C3%AD">2.1.2. Spuštění</a></li>
</ul>
</li>
<li><a href="#22-program-mainpy">2.2. Program <code>main.py</code></a>
<ul>
<li><a href="#221-pr%C3%A1ce-s-daty">2.2.1. Práce s daty</a>
<ul>
<li><a href="#2211-seznam-senzor%C5%AF">2.2.1.1. Seznam senzorů</a></li>
<li><a href="#2212-seznam-tag%C5%AF">2.2.1.2. Seznam tagů</a></li>
<li><a href="#2213-seznam-m%C4%9B%C5%99en%C3%BDch-hodnot">2.2.1.3. Seznam měřených hodnot</a></li>
</ul>
</li>
<li><a href="#222-konstrukce-http-post">2.2.2. Konstrukce HTTP POST</a></li>
<li><a href="#223-iterace-smy%C4%8Dkou">2.2.3. Iterace smyčkou</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#3-grafana">3. Grafana</a>
<ul>
<li><a href="#31-pou%C5%BEit%C3%AD">3.1. Použití</a></li>
<li><a href="#32-popis-datab%C3%A1ze">3.2. Popis databáze</a>
<ul>
<li><a href="#321-seznam-m%C4%9B%C5%99en%C3%AD">3.2.1. Seznam měření</a></li>
<li><a href="#322-seznam-tag%C5%AF">3.2.2. Seznam tagů</a></li>
<li><a href="#323-seznam-m%C4%9B%C5%99en%C3%BDch-hodnot">3.2.3. Seznam měřených hodnot</a></li>
<li><a href="#324-datov%C3%A1-struktura">3.2.4. Datová struktura</a></li>
</ul>
</li>
<li><a href="#33-dashboard-fis-bc-jeho-panely-a-upozorn%C4%9Bn%C3%AD">3.3. Dashboard FIS-Bc, jeho panely a upozornění</a>
<ul>
<li><a href="#331-celkov%C3%BD-v%C3%BDkon">3.3.1. Celkový výkon</a>
<ul>
<li><a href="#3311-flux-dotaz">3.3.1.1. Flux dotaz</a></li>
<li><a href="#3312-transformace-dat">3.3.1.2. Transformace dat</a></li>
</ul>
</li>
<li><a href="#332-pr%C5%AFm%C4%9Brn%C3%BD-v%C3%BDkon">3.3.2. Průměrný výkon</a>
<ul>
<li><a href="#3321-flux-dotaz">3.3.2.1. Flux dotaz</a></li>
</ul>
</li>
<li><a href="#333-kumulativn%C3%AD-v%C3%BDroba">3.3.3. Kumulativní výroba</a>
<ul>
<li><a href="#3331-flux-dotaz">3.3.3.1. Flux dotaz</a></li>
<li><a href="#3332-transformace-dat">3.3.3.2. Transformace dat</a></li>
</ul>
</li>
<li><a href="#334-upozorn%C4%9Bn%C3%AD">3.3.4. Upozornění</a>
<ul>
<li><a href="#3341-upozorn%C4%9Bn%C3%AD-v%C3%BDkon">3.3.4.1. Upozornění: Výkon</a>
<ul>
<li><a href="#33411-flux-dotazy-pro-upozorn%C4%9Bn%C3%AD">3.3.4.1.1. Flux dotazy pro upozornění</a>
<ul>
<li><a href="#334111-a">3.3.4.1.1.1. A</a></li>
<li><a href="#334112-b">3.3.4.1.1.2. B</a></li>
<li><a href="#334113-c">3.3.4.1.1.3. C</a></li>
</ul>
</li>
<li><a href="#33412-nastaven%C3%AD">3.3.4.1.2. Nastavení</a></li>
</ul>
</li>
<li><a href="#3342-upozorn%C4%9Bn%C3%AD-hladina">3.3.4.2. Upozornění: Hladina</a>
<ul>
<li><a href="#33421-flux-dotazy-pro-upozorn%C4%9Bn%C3%AD">3.3.4.2.1. Flux dotazy pro upozornění</a>
<ul>
<li><a href="#334211-a">3.3.4.2.1.1. A</a></li>
<li><a href="#334212-b">3.3.4.2.1.2. B</a></li>
</ul>
</li>
<li><a href="#33422-nastaven%C3%AD">3.3.4.2.2. Nastavení</a></li>
</ul>
</li>
<li><a href="#3343-upozorn%C4%9Bn%C3%AD-teplota">3.3.4.3. Upozornění: Teplota</a>
<ul>
<li><a href="#33431-flux-dotazy-pro-upozorn%C4%9Bn%C3%AD">3.3.4.3.1. Flux dotazy pro upozornění</a>
<ul>
<li><a href="#334311-a">3.3.4.3.1.1. A</a></li>
<li><a href="#334312-b">3.3.4.3.1.2. B</a></li>
</ul>
</li>
<li><a href="#33432-nastaven%C3%AD">3.3.4.3.2. Nastavení</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#335-v%C3%BDkon-tg1-a-v%C3%BDkon-tg2">3.3.5. Výkon TG1 a Výkon TG2</a>
<ul>
<li><a href="#3351-flux-dotaz-pro-v%C3%BDkon-tg1">3.3.5.1. Flux dotaz pro Výkon TG1</a></li>
<li><a href="#3352-flux-dotaz-pro-v%C3%BDkon-tg2">3.3.5.2. Flux dotaz pro Výkon TG2</a></li>
</ul>
</li>
<li><a href="#336-hladina-nad-tg1-a-hladina-nad-tg2">3.3.6. Hladina nad TG1 a Hladina nad TG2</a>
<ul>
<li><a href="#3361-flux-dotaz-pro-hladina-nad-tg1">3.3.6.1. Flux dotaz pro Hladina nad TG1</a></li>
<li><a href="#3362-flux-dotaz-pro-hladina-nad-tg2">3.3.6.2. Flux dotaz pro Hladina nad TG2</a></li>
</ul>
</li>
<li><a href="#337-hladina-pod-tg1-a-hladina-pod-tg2">3.3.7. Hladina pod TG1 a Hladina pod TG2</a>
<ul>
<li><a href="#3371-flux-dotaz-pro-hladina-pod-tg1">3.3.7.1. Flux dotaz pro Hladina pod TG1</a></li>
<li><a href="#3372-flux-dotaz-pro-hladina-pod-tg2">3.3.7.2. Flux dotaz pro Hladina pod TG2</a></li>
</ul>
</li>
<li><a href="#338-teplota-lo%C5%BEiska-gener%C3%A1toru-tg1-a-teplota-lo%C5%BEiska-gener%C3%A1toru-tg2">3.3.8. Teplota ložiska generátoru TG1 a Teplota ložiska generátoru TG2</a>
<ul>
<li><a href="#3381-flux-dotaz-pro-teplota-lo%C5%BEiska-gener%C3%A1toru-tg1">3.3.8.1. Flux dotaz pro Teplota ložiska generátoru TG1</a></li>
<li><a href="#3382-flux-dotaz-pro-teplota-lo%C5%BEiska-gener%C3%A1toru-tg2">3.3.8.2. Flux dotaz pro Teplota ložiska generátoru TG2</a></li>
</ul>
</li>
<li><a href="#339-teplota-lo%C5%BEiska-turb%C3%ADny-tg1-a-teplota-lo%C5%BEiska-turb%C3%ADny-tg2">3.3.9. Teplota ložiska turbíny TG1 a Teplota ložiska turbíny TG2</a>
<ul>
<li><a href="#3391-flux-dotaz-pro-teplota-lo%C5%BEiska-gener%C3%A1toru-tg1">3.3.9.1. Flux dotaz pro Teplota ložiska generátoru TG1</a></li>
<li><a href="#3392-flux-dotaz-pro-teplota-lo%C5%BEiska-gener%C3%A1toru-tg2">3.3.9.2. Flux dotaz pro Teplota ložiska generátoru TG2</a></li>
</ul>
</li>
<li><a href="#3310-v%C3%BDkon">3.3.10. Výkon</a>
<ul>
<li><a href="#33101-flux-dotaz-pro-v%C3%BDkon">3.3.10.1. Flux dotaz pro Výkon</a></li>
<li><a href="#33102-transformace-dat">3.3.10.2. Transformace dat</a></li>
</ul>
</li>
<li><a href="#3311-v%C3%BDkon">3.3.11. Výkon</a>
<ul>
<li><a href="#33111-flux-dotaz-pro-v%C3%BDkon">3.3.11.1. Flux dotaz pro Výkon</a></li>
<li><a href="#33112-transformace-dat">3.3.11.2. Transformace dat</a></li>
</ul>
</li>
<li><a href="#3312-hladina">3.3.12. Hladina</a>
<ul>
<li><a href="#33121-flux-dotaz-pro-hladina">3.3.12.1. Flux dotaz pro Hladina</a></li>
</ul>
</li>
<li><a href="#3313-pr%C5%AFm%C4%9Brn%C3%A1-hladina-nad-mve">3.3.13. Průměrná hladina nad MVE</a>
<ul>
<li><a href="#33131-flux-dotaz-pro-pr%C5%AFm%C4%9Brn%C3%A1-hladina-nad-mve">3.3.13.1. Flux dotaz pro Průměrná hladina nad MVE</a></li>
<li><a href="#33132-transformace-dat">3.3.13.2. Transformace dat</a></li>
</ul>
</li>
<li><a href="#3314-pr%C5%AFm%C4%9Brn%C3%A1-hladina-pod-mve">3.3.14. Průměrná hladina pod MVE</a>
<ul>
<li><a href="#33141-flux-dotaz-pro-pr%C5%AFm%C4%9Brn%C3%A1-hladina-pod-mve">3.3.14.1. Flux dotaz pro Průměrná hladina pod MVE</a></li>
<li><a href="#33142-transformace-dat">3.3.14.2. Transformace dat</a></li>
</ul>
</li>
<li><a href="#3315-teplota-lo%C5%BEisek">3.3.15. Teplota ložisek</a>
<ul>
<li><a href="#33151-flux-dotaz-pro-teplota-lo%C5%BEisek">3.3.15.1. Flux dotaz pro Teplota ložisek</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="úvod">Úvod</h2>
<p>Tento dokument obsahuje dokumentaci programového vybavení, jež je součástí bakalářské práce Adama Valtra na téma Řízení malé vodní elektrárny vypracované v roce 2021 na Fakultě informatiky a statistiky Vysoké školy ekonomické v Praze.</p>
<p>Vypracované programové vybavení zahrnuje CLI nástroj napsaný v <code>Bash Shell</code>, který na systému s Linux Debian nebo distribuci z něj odvozenou dokáže nainstalovat, nakonfigurovat nebo odinstalovat databázový server InfluxDB a webovou analytickou a vizualizační platformu Grafana tak, aby klientské zařízení (v tomto případě MVE) mohlo odesílat svá senzorová data na server přes zabezpečené <code>HTTPS</code>, a tato data byla dostupná pro následnou analýzu a vizualizaci v Grafana.</p>
<p>Dalším článkem programového vybavení je program v jazyce <code>Python</code>, který představuje klienta (MVE), který odesílá senzorová data do databáze. Tento program má za úkol nahradit reálnou MVE jako zdroj senzorových dat. V době vypracovávání práce autor nezískal přístup k reálné MVE, kterou by bylo možné nastavit/upravit pro odesílání dat o jejím stavu na vzdálený server prostřednictvím sítě Internet. Program pravidelně generuje data a odesílá je jako <code>HTTP POST</code> požadavky serveru. Struktura a hodnoty generovaných dat jsou v programu implementovány tak, aby v omezené a zjednodušené míře imitovala data, která by skutečná MVE mohla o svém stavu sbírat a reportovat o nich.</p>
<p>Vypracované programové vybavení také zahrnuje šablonu dashboardu Grafana, jenž obsahuje přednastavené panely a upozornění pro vizualizaci a analýzu dat získávaných z implementované databáze.</p>
<p>Celý soubor programového vybavení tedy funguje jako celek a jeho jednotlivé části se navzájem doplňují.</p>
<p>Při popisu cesty k jednotlivým částem softwarového vybavení se za kořenový adresář <code>/</code> považuje <code>FIS-Bc</code> - pokud není uvedeno jinak, cesty jsou uváděny relativně k němu.</p>
<h3 id="členění-dokumentace">Členění dokumentace</h3>
<p>Dokumentace je rozdělena do tří hlavních kapitol zastřešujících funkční celky v pořadí ve kterém autor doporučuje programové vybavení použít:</p>
<ul>
<li>Server
<ul>
<li>CLI nástroj pro automatizovanou instalaci a konfiguraci InfluxDB a Grafana.</li>
</ul>
</li>
<li>Klient
<ul>
<li>Program generující a odesílající senzorová data.</li>
</ul>
</li>
<li>Grafana
<ul>
<li>Popisuje ukázkový dashboard a upozornění v Grafana a jejich Flux dotazy do databáze.</li>
</ul>
</li>
</ul>
<hr>
<h3 id="adresářová-struktura">Adresářová struktura</h3>
<pre><code><code><div>FIS-Bc
│   README.md   
│
└───client
│   │   main.py
│   │   options.json
│   
└───grafana
│   │   dashboard_template.json
│   
└───server
    │   setup.sh
    │
    └───setup_lib
        │   configure.sh
        │   install.sh
        │   remove.sh
        │
        └───setup_lib
        │   config.toml
        │   grafana.ini
</div></code></code></pre>
<hr>
<h1 id="1-server">1. Server</h1>
<ul>
<li>Adresář: <code>/server</code></li>
</ul>
<p>Tato část dokumentace popisuje CLI nástroj <code>setup.sh</code> sestrojený v <code>Bash</code>, což je <code>Unix Shell</code> a interpreter příkazové řádky. Nástroj používá podružné skripty <code>configure.sh </code>, <code>install.sh</code> a <code>remove.sh</code> z podadresáře <code>/setup_lib</code> k exekuci konkrétních úkonů.</p>
<h2 id="11-použití">1.1. Použití</h2>
<p>Nástroj slouží primárně k automatizaci instalace a konfigurace InfluxDD a Grafana, ale také umožňuje software, který byl v jeho průběhu nainstalován zase odinstalovat včetně nasazené konfigurace.</p>
<p>Spuštění nástroje je možné např. příkazem <code>bash setup.sh</code>. Pamatujte, že je při exekuci nutné se nacházet v adresáři <code>/server</code> a struktura podadresářů ani názvy souborů nesmí být změněny bez korespondujících změn ve zdrojových kódech - jinak odkazy mezi jednotlivýmí skripty nebudou fungovat.</p>
<p>Chování nástroje je možné upravit pomocí možností, které se skriptu předávají jako tzv. vlajky (flags). Například příkaz <code>bash setup.sh -h</code> zobrazí nápovědu. Všechny možnosti popisuje následující tabulka.</p>
<table>
<thead>
<tr>
<th>Vlajka</th>
<th style="text-align:left">Popis</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-d</code></td>
<td style="text-align:left">vlajka k ladění (debugging). Podružné skripty se spustí s povolenou možností: -x</td>
</tr>
<tr>
<td><code>-h</code></td>
<td style="text-align:left">zobrazí  manuál</td>
</tr>
<tr>
<td><code>-i</code></td>
<td style="text-align:left">nainstaluje softwarové vybavení pomocí setup_lib/install.sh</td>
</tr>
<tr>
<td><code>-c</code></td>
<td style="text-align:left">nasadí konfiguraci softwarového vybavení pomocí setup_lib/install.sh</td>
</tr>
<tr>
<td><code>-r</code></td>
<td style="text-align:left">odstraní nainstalovaný software a konfiguraci učiněné setup_lib/install.sh a setup_lib/configure.sh</td>
</tr>
</tbody>
</table>
<p>Pokud dojde ke spuštění bez vlajky, dojde ke standardnímu průběhu, který představuje instalaci a konfiguraci. Tento standardní průběh je totožný s použitím vlajek <code>-i</code> a <code>-c</code> dohromady - tedy <code>bash setup.sh -ic</code>.</p>
<p>Uvede-li se vlajka, která není definována, program do příkazové řádky vytiskne zprávu, že takovou možnost nezná a skončí.</p>
<p>Zahrnuje-li průběh nástroje spuštění podružných skriptů <code>configure.sh </code>, <code>install.sh</code> a <code>remove.sh</code> z podadresáře <code>/setup_lib</code>, dojde vždy k výzvě uživatele o potvrzení, zda si opravdu přeje pokračovat. Prvním krokem, který pak podružný skript učiní, je kontrola operačního systému hosta. Tato kontrola je důležitá, neboť zmíněné skripty přímo interagují se systémem a dělají v něm změny. Při exekuci na nepodporovaném systému by nebylo možné zaručit správné fungování skriptů a mohlo by způsobit něžádoucí změny. Kontrola se provádí čtením obsahu <code>/etc/os-release</code> ve kterém se hledá fráze <code>debian</code>. Distribuce Linux Debian obsahuje <code>debian</code> pod klíčem <code>ID</code>. Distribuce založené na Debianu uvádí <code>debian</code> pod klíčem <code>ID_LIKE</code>. Pokud nedojde k úspěšnému splnění této kontroly, skript nebude pokračovat a ukončí se.</p>
<p>Nástroj komunikuje s uživatelem prostřednictvím příkazové řádky. V různých částech exekuce může být uživatel dotazován na potvrzení následného kroku formou souhlasu, či nesouhlasu, který je vždy reprezentován jako nabídka s volbami, na kterou se odpovídá indexem volby.</p>
<p>Následující výpis kódu reprezentuje jednu takovou volbu. Jedná se o již zmiňovaný souhlas se spuštěním. Uživatel na něj může odpovědět zadáním <code>1</code> pro volbu <code>Ano</code> nebo <code>2</code> pro <code>Ne</code> a potvrdit klávesou <code>enter</code>.</p>
<pre><code class="language-Bash"><div><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Přejete si pokračovat v exekuci skriptu <span class="hljs-variable">${0##*/}</span>? (Zadejte &#x27;1&#x27; nebo &#x27;2&#x27; pro výběr možnosti)&quot;</span>
select yn <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;Ano&quot;</span> <span class="hljs-string">&quot;Ne&quot;</span>; <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">case</span> <span class="hljs-variable">$yn</span> <span class="hljs-keyword">in</span>
        Ano ) execute; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Skript <span class="hljs-variable">${0##*/}</span> úspěšně dokončen&quot;</span>; <span class="hljs-built_in">break</span>;;
        Ne ) <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Spuštění skriptu <span class="hljs-variable">${0##*/}</span> odmítnuto.&quot;</span>; <span class="hljs-built_in">exit</span>;;
    <span class="hljs-keyword">esac</span>
<span class="hljs-keyword">done</span>
</div></code></pre>
<p>Dalším příkladem komunikace, při které je vyžadován uživatelský vstup, je žádost o zadání konkrétní hodnoty, která se má v daném kroku použít. Uživateli je nabídnuta přednastavená hodnota, se kterou může buď souhlasit, nebo jí změnit na hodnotu odpovídající jeho potřebám a prostředí. Pokud se rozhodne hodnotu změnit, učiní tak výběrem patřičné volby a následně vpíše do příkazové řádky novou hodnotu, která se má použít.</p>
<p>Pro ilustraci - ve výpisu kódu níže, je uživatel dotazován na nové heslo pro přihlášení do Grafana. Může se použít předvyplněné heslo a nebo heslo, které uživatel zadá. Nejdříve je nutné vybrat volbu zadáním <code>1</code> a potvrzením klávesou <code>enter</code>, poté je možné do příkazové řádky vepsat novou hodnotu a opět potvrdit klávesou <code>enter</code>.</p>
<pre><code class="language-Bash"><div><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Předvyplněné heslo je: <span class="hljs-variable">$grafanapass</span>. Chcete ho změnit?&quot;</span>
select yn <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;Ano&quot;</span> <span class="hljs-string">&quot;Ne&quot;</span>; <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">case</span> <span class="hljs-variable">$yn</span> <span class="hljs-keyword">in</span>
        Ano ) <span class="hljs-built_in">read</span> -p -s <span class="hljs-string">&quot;Zadejte nové heslo: &quot;</span> grafanapass; <span class="hljs-built_in">break</span>;;
        Ne ) <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Použije se heslo: <span class="hljs-variable">$grafanapass</span>.&quot;</span>; <span class="hljs-built_in">break</span>;;
    <span class="hljs-keyword">esac</span>
<span class="hljs-keyword">done</span>
</div></code></pre>
<p>O reportování neúspěšné exekuce nějakého kroku skriptu se stará funkce <code>status_report()</code>. Ta do příkazové řádky vpíše, název funkce, které se něco nezdařilo a hlášku vysvětlující, co se nezdařilo. Poté ohlásí: <code>&quot;Skript nebylo možné dokončit.&quot;</code> a ukončí exekuci.</p>
<pre><code class="language-Bash"><div><span class="hljs-comment"># Neúspěšná funkce volá</span>

status_report <span class="hljs-variable">${FUNCNAME[0]}</span> <span class="hljs-string">&quot;Nepodporovaný OS.&quot;</span>

<span class="hljs-comment"># Reportovací funkce reportuje do příkazové řádky a ukončuje exekuci</span>
<span class="hljs-function"><span class="hljs-title">status_report</span></span>() {
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;FUNKCE: <span class="hljs-variable">$1</span> HLÁSÍ: <span class="hljs-variable">$2</span>&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Skript nebylo možné dokončit.&quot;</span>; <span class="hljs-built_in">exit</span>
}
</div></code></pre>
<hr>
<h2 id="12-skript-installsh">1.2. Skript <code>install.sh</code></h2>
<p>Tento podružný skript použije <code>apt</code> k instalci InfluxDB OSS v nejnovější dostupné verzi (aktuálně v2.1.1) a Grafana OSS v nejnovější dostupné verzi (aktuálně v8.3.1).</p>
<p>Průběh skriptem řídí funkce <code>execute()</code>. Ta volá tyto ostatní funkce v pořadí, jak jsou uvedeny:</p>
<table>
<thead>
<tr>
<th>Název funkce</th>
<th style="text-align:left">Popis</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>os_check()</code></td>
<td style="text-align:left">zkontroluje zda <code>/etc/os-release</code> obsahuje frázy <code>debian</code></td>
</tr>
<tr>
<td><code>package_update()</code></td>
<td style="text-align:left"><code>apt</code> aktualizuje seznam dostupných balíčků a nainstaluje aktualizace - pokud jsou k dispozici</td>
</tr>
<tr>
<td><code>install_depend()</code></td>
<td style="text-align:left">pokud nutno, nainstaluje nástroje nutné k úspěšné exekuci skriptu (<code>wget gpg apt-transport-https software-properties-common</code>)</td>
</tr>
<tr>
<td><code>add_influx_repo()</code></td>
<td style="text-align:left">přidá repozitář InfluxDB a jeho veřejný klíč do zdrojů <code>apt</code></td>
</tr>
<tr>
<td><code>add_grafana_repo()</code></td>
<td style="text-align:left">přidá repozitář Grafana a jeho veřejný klíč do zdrojů <code>apt</code></td>
</tr>
<tr>
<td><code>package_update()</code></td>
<td style="text-align:left">znovu zaktualizuje, neboť byly přidány nové repozitáře</td>
</tr>
<tr>
<td><code>install_influxDB()</code></td>
<td style="text-align:left">nainstaluje InfluxDB OSS v nejnovější dostupné verzi z přidaného repozitáře</td>
</tr>
<tr>
<td><code>install_grafana()</code></td>
<td style="text-align:left">nainstaluje Grafana OSS v nejnovější dostupné verzi z přidaného repozitáře</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="13-skript-configuresh">1.3. Skript <code>configure.sh</code></h2>
<p>Tímto skriptem je výrazně zautomatizován proces nastavení InfluxDB a Grafana. Vytvoří databázi a připraví ji pro čtení a zápis na základě autorizace <code>API Tokeny</code>, změní defaultní hesla a dokáže obstarat <code>TLS</code> certifikát podepsaný Let's Encrypt, který umožní komunikaci s databází přes <code>HTTPS</code>.</p>
<p>Mnoho kroků tohoto skriptu vyžaduje vstup od uživatele. Aby nebylo nutné dotazované hodnoty zadávat ručně, je možné je předvyplnit do proměnných ve zdrojovém kódu. Předvyplnitelné proměnné jsou:</p>
<table>
<thead>
<tr>
<th>Název proměnné</th>
<th style="text-align:left">Popis</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>domain</code></td>
<td style="text-align:left">doménové jméno pro použití s <code>TLS</code> certifikátem</td>
</tr>
<tr>
<td><code>influxbucket</code></td>
<td style="text-align:left">název kbelíku (bucket), který bude v InfluxDB databázi vytvořen</td>
</tr>
<tr>
<td><code>influxuser</code></td>
<td style="text-align:left">uživatelské jméno pro administrátorský účet InfluxDB databáze</td>
</tr>
<tr>
<td><code>influxpass</code></td>
<td style="text-align:left">heslo pro administrátorský účet InfluxDB databáze</td>
</tr>
<tr>
<td><code>influxorg</code></td>
<td style="text-align:left">název organizace InfluxDB databáze</td>
</tr>
<tr>
<td><code>grafanapass</code></td>
<td style="text-align:left">heslo pro administrátorský účet platformy Grafana</td>
</tr>
</tbody>
</table>
<p>Průběh skriptem řídí funkce <code>execute()</code>. Ta volá tyto ostatní funkce v pořadí, jak jsou uvedeny:</p>
<table>
<thead>
<tr>
<th>Název funkce</th>
<th style="text-align:left">Popis</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>os_check()</code></td>
<td style="text-align:left">zkontroluje zda <code>/etc/os-release</code> obsahuje frázy <code>debian</code></td>
</tr>
<tr>
<td><code>install_depend()</code></td>
<td style="text-align:left">pokud nutno, nainstaluje nástroje nutné k úspěšné exekuci skriptu (<code>jq</code>)</td>
</tr>
<tr>
<td><code>init_influx()</code></td>
<td style="text-align:left">spustí proces prvotního nastavení InfluxDB, ve kterém si uživatel nastaví uživatelské jméno, heslo, organizaci a tzv. kbelík (bucket) pro data, a vygenerují se potřebné <code>API Tokeny</code></td>
</tr>
<tr>
<td><code>init_grafana()</code></td>
<td style="text-align:left">změní defaultní heslo pro administrátorský účet <code>admin</code> v Grafana</td>
</tr>
<tr>
<td><code>ask_domain()</code></td>
<td style="text-align:left">zeptá se uživatele na doménové jméno pro použití s <code>TLS</code> certifikátem</td>
</tr>
<tr>
<td><code>use_certbot()</code></td>
<td style="text-align:left">zeptá se uživatele, zda chce obstarat certifikát pomocí <code>certbot</code></td>
</tr>
<tr>
<td><code>deploy_tls_config()</code></td>
<td style="text-align:left">zazálohuje defaultní konfiguraci InfluxDB a Grafana a nasadí konfiguraci povolující TLS</td>
</tr>
</tbody>
</table>
<h3 id="131-konfigurační-soubory-influxdb-configtoml-a-grafana-grafanaini">1.3.1. Konfigurační soubory InfluxDB <code>config.toml</code> a Grafana <code>grafana.ini</code></h3>
<p>Upravuje nastavení databázového serveru InfluxDB platformy Grafana, aby pro komunikaci používaly namísto <code>HTTP</code> zabezpečené <code>HTTPS</code> pomocí certifikátu a klíče od Let's Encrypt obstaraného pomocí <code>certbot</code>.</p>
<p>Tyto soubory použije funkce <code>deploy_tls_config()</code> k nasazení <code>TLS</code>.</p>
<hr>
<h2 id="14-skript-removesh">1.4. Skript <code>remove.sh</code></h2>
<p>Odinstaluje software nainstalovaný skriptem <code>install.sh</code>, odebere přidané repozitáře a klíče a odstraní konfiguraci učiněnou skriptem <code>configure.sh</code>. Jeho zamýšlené použití je především pro případy, že z nějakého důvodu instalace či konfigurace patřičnými skripty byla neúspěšná. Pak se jednoduše použije <code>bash setup.sh -r</code>, který se postará o odstranění kroků učiněných <code>install.sh</code> a <code>configure.sh</code>.</p>
<p>Průběh skriptem řídí funkce <code>execute()</code>. Ta volá tyto ostatní funkce v pořadí, jak jsou uvedeny:</p>
<table>
<thead>
<tr>
<th>Název funkce</th>
<th style="text-align:left">Popis</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>os_check()</code></td>
<td style="text-align:left">zkontroluje zda <code>/etc/os-release</code> obsahuje frázy <code>debian</code></td>
</tr>
<tr>
<td><code>remove_install()</code></td>
<td style="text-align:left">odinstaluje balíčky <code>influxdb2</code> a <code>grafana</code> a odebere z <code>apt</code> jejich repozitáře a klíče</td>
</tr>
<tr>
<td><code>remove_configuration()</code></td>
<td style="text-align:left">odinstaluje balíček <code>certbot</code> a rekurzivně odstraní adresáře <code>/etc/grafana</code> a <code>/etc/influxdb</code></td>
</tr>
</tbody>
</table>
<hr>
<h1 id="2-klient">2. Klient</h1>
<ul>
<li>Adresář: <code>/client</code></li>
</ul>
<p>Popis programu napsaného v jazyce <code>Python</code>, který slouží ke generování a odesílání dat do databázového serveru pomocí <code>HTTP POST</code> požadavků.</p>
<h2 id="21-použití">2.1. Použití</h2>
<p>Program je zamýšlen jako generátor dat, běžící v nekonečné smyčce na zařízení s přístupem k internetu, aby mohl vygenerovaná data v patřičném formátu odesílat na <code>API</code> databázového serveru.</p>
<p>Program se spouští bez argumentů, např. příkazem <code>python3 main.py</code>. Součástí programu je konfigurační soubor <code>options.json</code>, který musí být nutně umístěn ve stejném adresáři jako samotný program. Před samotným spuštěním programu by měl uživatel upravit konfigurační soubor, aby odpovídal jeho specifickým podmínkám.</p>
<h3 id="211-konfigurační-soubor">2.1.1. Konfigurační soubor</h3>
<p>Tento soubor je načten při spuštění programu <code>main.py</code>. Názvy jednotlivých klíčů není možné změnit bez korespondující změny ve zdrojovém kódu programu - jinak program nebude fungovat. Pokud neplánujete měnit samotný program, upravujte pouze hodnoty pod klíči. Dostupná nastavení jsou:</p>
<table>
<thead>
<tr>
<th>Nastavení</th>
<th>Popis</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>protocol</code></td>
<td>http nebo https</td>
</tr>
<tr>
<td><code>domain</code></td>
<td>doménové jméno směřující na adresu Vaší InfluxDB instance. Lze zadat přímo <code>IPv4</code> adresu</td>
</tr>
<tr>
<td><code>port</code></td>
<td><code>TCP/IP</code> port na kterém je InfluxDB dostupná. Defaultně <code>8086</code></td>
</tr>
<tr>
<td><code>org</code></td>
<td>název organizace, který byl zadán při tvorbě databáze</td>
</tr>
<tr>
<td><code>bucket</code></td>
<td>název kbelíku, který byl zadán při tvorbě databáze</td>
</tr>
<tr>
<td><code>precision</code></td>
<td>přesnost s jakou databáze k příchozím datům přiřadí časovou značku (<code>us, ns, ms, s</code>)</td>
</tr>
<tr>
<td><code>token</code></td>
<td><code>API Token</code> autorizující klienta k zápisu do uvedeného kbelíku databáze</td>
</tr>
<tr>
<td><code>period</code></td>
<td>čas v sekundách definující prodlevu mezi iteracemi generování a odesílání dat</td>
</tr>
</tbody>
</table>
<h3 id="212-spuštění">2.1.2. Spuštění</h3>
<p>Jelikož program běží v nekonečné smyčce, je vhodné ho sputit na pozadí. Pokud například chceme program spustit na vzdáleném zařízení, ke kterému přistupujeme přes <code>SSH</code>, pak je nutné proces, který spuštěním programu vznikne, oddělit od samotné <code>SSH session</code>, jinak by byl proces při ukončení <code>session</code> terminován. Na zařízení s operařním systémem Linux toho lze docílit například použitím <code>setsid</code>, které procesu vytvoří vlastní <code>session</code>. Výsledný příkaz pak může vypadat takto: <code>setsid python3 main.py</code>.</p>
<p>Vhodným zařízením pro spuštění programu je takové, které funguje v nepřetržitém provozu. Tím bude zabezpečeno, že nedojde k ukončení programu a tedy přerušení odesílání dat do databáze. Pro toto použití je vhodné např. <code>Raspberry Pi</code> apod.</p>
<hr>
<h2 id="22-program-mainpy">2.2. Program <code>main.py</code></h2>
<p>Fungování programu bylo testováno na Debian 11 s Python verze 3.9.</p>
<p>Použité balíčky:</p>
<ul>
<li>json</li>
<li>time</li>
<li>random</li>
<li>requests</li>
</ul>
<h3 id="221-práce-s-daty">2.2.1. Práce s daty</h3>
<p>Data, která se odesílají do databáze jsou popsána slovníkem <code>data_structure</code>. Tato data představují ilustrativní senzory, kterými bývají běžně osazeny malé vodní elektrárny. Jsou to měřídla výkonu generátorů, hladinové sondy a teplotní čidla. Slovník obsahuje celkem deset sond - dvě měřidla výkonu, čtyři hladinové sondy a čtyři teplotní čidla. Myšlená MVE, kterou se data snaží ilustrovat, je osazena dvěma turbínovými soustrojími. Na každé soustrojí tak připadá jedno měřidlo výkonu, dvě hladinové sondy a dvě teplotní čidla.</p>
<p>Každy senzor je ve slovníku reprezentován klíčem. Hodnotou každého klíče je pak vnořený slovník, který obsahuje dva tagy a měřenou hodnotu typu <code>integer</code>. Tagy určují k jakému soustrojí daný senzor patří a o jaký typ senzoru se jedná.</p>
<h4 id="2211-seznam-senzorů">2.2.1.1. Seznam senzorů</h4>
<ul>
<li><code>merVykonu1</code></li>
<li><code>merVykonu2</code></li>
<li><code>merHladiny1</code></li>
<li><code>merHladiny2</code></li>
<li><code>merHladiny3</code></li>
<li><code>merHladiny4</code></li>
<li><code>merTeploty1</code></li>
<li><code>merTeploty2</code></li>
<li><code>merTeploty3</code></li>
<li><code>merTeploty4</code></li>
</ul>
<h4 id="2212-seznam-tagů">2.2.1.2. Seznam tagů</h4>
<ul>
<li><code>tag1</code></li>
<li><code>tag2</code></li>
</ul>
<h4 id="2213-seznam-měřených-hodnot">2.2.1.3. Seznam měřených hodnot</h4>
<ul>
<li><code>vykonkWh</code></li>
<li><code>hladinaCm</code></li>
<li><code>teplotaCelsia</code></li>
</ul>
<p>Aby docházelo ke změně měřených hodnot a do databáze se dokola nezapisovala stejná data, jsou v každé iteraci volány funkce <code>change_temperature()</code>, <code>change_level()</code> a <code>change_power()</code>. Tyto funkce náhodně změní hodnotu daného měření z předchozí iterace o <code>integer</code> z rozmezí <code>&lt;-1;1&gt;</code>. Jelikož by takto náhodně upravovaná data mohla nabývat hodnot, která by v kontextu ilustrace reálné MVE byla nesmyslná, volá se po každé změně funkce <code>norm_value()</code>, která zaručuje, že se hodnoty měření nevychýlí z přednastavených rozmezí. Rozmezí pro jednotlivé typy měření jsou uvedeny v následující tabulce.</p>
<table>
<thead>
<tr>
<th>Název hodnoty</th>
<th style="text-align:right">Rozmezí</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vykonkWh</code></td>
<td style="text-align:right"><code>&lt;0;60&gt;</code></td>
</tr>
<tr>
<td><code>hladinaCm</code></td>
<td style="text-align:right"><code>&lt;-20;20&gt;</code></td>
</tr>
<tr>
<td><code>teplotaCelsia</code></td>
<td style="text-align:right"><code>&lt;-5;90&gt;</code></td>
</tr>
</tbody>
</table>
<h3 id="222-konstrukce-http-post">2.2.2. Konstrukce HTTP POST</h3>
<p>InfluxDB API očekává <code>HTTP POST</code> požadavek v přesně definované struktuře.</p>
<p>Každý <code>HTTP POST</code> požadavek musí obsahovat:</p>
<ul>
<li>Název organizace nebo její ID</li>
<li>Název cílového kbelíku (bucket)</li>
<li>API Token</li>
<li>InfluxDB URL</li>
<li>Data ve formátu <code>line protocol</code></li>
</ul>
<p>Pro kompletní dokumentaci InfluxDB API navštivte:</p>
<p><a href="https://docs.influxdata.com/influxdb/v2.1/api/#operation/PostWrite">https://docs.influxdata.com/influxdb/v2.1/api/#operation/PostWrite</a></p>
<p>Organizaci, kbelík, token a adresu program vyplní z informací uvedených v <code>options.json</code>.</p>
<p>Data je před odesláním nutné transformovat ze slovníku <code>data_structure</code> do formátu <code>line protocol</code>. To se provede zavoláním funkce <code>transform_data()</code>.</p>
<h3 id="223-iterace-smyčkou">2.2.3. Iterace smyčkou</h3>
<p>Nekonečná smyčka v každé své iteraci volá funkci <code>iterate()</code> a poté čeká <code>period</code> sekund. Proměnná <code>period</code> je <code>integer</code> nažtený z hodnoty klíče <code>period</code> v <code>options.json</code>.</p>
<p>Funkce <code>iterate()</code> má nastarost volat ostatní funkce ke změně dat, jejich transformaci a odeslání na server.</p>
<hr>
<h1 id="3-grafana">3. Grafana</h1>
<ul>
<li>Adresář: <code>/grafana</code></li>
</ul>
<p>Popis ukázkového dashboardu a upozornění v Grafana a jejich Flux dotazy do databáze.</p>
<h2 id="31-použití">3.1. Použití</h2>
<p>Nedílnou součástí vypracovaného programového vybavení je Grafana Dashboard, který prezentuje a analyzuje data získávaná z implementované Influx databáze. Účelem tohoto dashboardu je nabídnout obsluze malé vodní elektrárny uživatelsky přívětivý způsob jak monitorovat senzorová data elektrárny a také nad daty automatizovaně provádět logické operace, jež dokáží vyhodnocovat, zda se elektrárna nenachází v kritickém nebo nestandardním stavu, a na takovou skutečnost obsluhu upozornit.</p>
<p>Nastavení dashboardu předpokládá, že InfluxDB a v ní uložená data odpovídají implementaci z částí <code>Server</code> a <code>Klient</code> tohoto programového vybavení. Nicméně lze šablonu upravit přímo v jejím zdrojovém kódu nebo v UI webové aplikace Grafana, aby vyhovovala vlastním potřebám odchylujícím se od předpracované konfigurace.</p>
<p>Pro import dashboardu do Grafana je nutné se nejprve přihlásit do webové aplikace. Pokud byl k instalaci a počáteční konfiguraci použit CLI nástroj ze <code>/server/setup.sh</code>, pak má <code>URL</code> webové aplikace formát <code>https://[doména]:3000</code> a přihlašovací údaje odpovídají hodnotám, které uživatel uvedl v průběhu exekuce zmíněného skriptu. V opačném případě je v defaultním nastavení Grafana dostupná z <code>http://[IP]:3000</code>, kde <code>IP</code> je <code>IPv4</code> adresa serveru, kam byla Grafana nainstalována. Přihlašovací jméno a heslo je pak <code>admin</code>.</p>
<p>Dále je před samotným importem dashboardu nutné přidat datový zdroj. V tomto případě se jedná o InfluxDB. To lze provést navigací do <code>Configuration &gt; Datasources &gt; Add data source &gt; InfluxDB</code>, kde je nutné zadat následující údaje o databázi (upravte pro Vaše prostředí):</p>
<ul>
<li>URL: <code>https://[doména]:8086</code> (adresa na které je databáze dostupná),</li>
<li>Organization: <code>fis-bc</code> (název organizace uvedený při tvorbě databáze),</li>
<li>Token: <code>API Token</code> (API Token vygenerovaný InfluxDB pro Grafana),</li>
<li>Default Bucket: <code>mve</code> (název kbelíku uvedený při tvorbě databáze).</li>
</ul>
<p>Naimportovat dashboard je možné navigací do <code>Create &gt; Import &gt; Upload JSON file</code>.</p>
<p>Šablona dashboardu je k nalezení v <code>dashboard_template.json</code></p>
<p>Nasazený a plně funkční dashboard na si lze prohlédnout na <a href="https://bc.linode.valtr.eu:3000">https://bc.linode.valtr.eu:3000</a>. Přihlašovací údaje pro uživatele s právy pouze na zobrazení (view-only) jsou <code>heslo: host</code> a <code>jméno: host</code>.</p>
<hr>
<h2 id="32-popis-databáze">3.2. Popis databáze</h2>
<ul>
<li>Databáze: <code>InfluxDB</code></li>
<li>Organizace: <code>fis-bc</code></li>
<li>Bucket: <code>mve</code></li>
</ul>
<h3 id="321-seznam-měření">3.2.1. Seznam měření</h3>
<ul>
<li><code>merVykonu1</code></li>
<li><code>merVykonu2</code></li>
<li><code>merHladiny1</code></li>
<li><code>merHladiny2</code></li>
<li><code>merHladiny3</code></li>
<li><code>merHladiny4</code></li>
<li><code>merTeploty1</code></li>
<li><code>merTeploty2</code></li>
<li><code>merTeploty3</code></li>
<li><code>merTeploty4</code></li>
</ul>
<h3 id="322-seznam-tagů">3.2.2. Seznam tagů</h3>
<ul>
<li><code>tag1</code></li>
<li><code>tag2</code></li>
</ul>
<h3 id="323-seznam-měřených-hodnot">3.2.3. Seznam měřených hodnot</h3>
<ul>
<li><code>vykonkWh</code></li>
<li><code>hladinaCm</code></li>
<li><code>teplotaCelsia</code></li>
</ul>
<h3 id="324-datová-struktura">3.2.4. Datová struktura</h3>
<ul>
<li><code>merVykonu1</code>
<ul>
<li><code>tag1</code> : <code>TG1</code></li>
<li><code>tag2</code> : <code>vykon</code></li>
<li><code>vykonkWh</code> : <code>[integer]</code></li>
<li><code>[timestamp]</code></li>
</ul>
</li>
<li><code>merVykonu2</code>
<ul>
<li><code>tag1</code> : <code>TG2</code></li>
<li><code>tag2</code> : <code>vykon</code></li>
<li><code>vykonkWh</code> : <code>[integer]</code></li>
<li><code>[timestamp]</code></li>
</ul>
</li>
<li><code>merHladiny1</code>
<ul>
<li><code>tag1</code> : <code>TG1</code></li>
<li><code>tag2</code> : <code>hladina</code></li>
<li><code>hladinaCm</code> : <code>[integer]</code></li>
<li><code>[timestamp]</code></li>
</ul>
</li>
<li><code>merHladiny2</code>
<ul>
<li><code>tag1</code> : <code>TG1</code></li>
<li><code>tag2</code> : <code>hladina</code></li>
<li><code>hladinaCm</code> : <code>[integer]</code></li>
<li><code>[timestamp]</code></li>
</ul>
</li>
<li><code>merHladiny3</code>
<ul>
<li><code>tag1</code> : <code>TG2</code></li>
<li><code>tag2</code> : <code>hladina</code></li>
<li><code>hladinaCm</code> : <code>[integer]</code></li>
<li><code>[timestamp]</code></li>
</ul>
</li>
<li><code>merHladiny4</code>
<ul>
<li><code>tag1</code> : <code>TG2</code></li>
<li><code>tag2</code> : <code>hladina</code></li>
<li><code>hladinaCm</code> : <code>[integer]</code></li>
<li><code>[timestamp]</code></li>
</ul>
</li>
<li><code>merTeploty1</code>
<ul>
<li><code>tag1</code> : <code>TG1</code></li>
<li><code>tag2</code> : <code>teplota</code></li>
<li><code>teplotaCelsia</code> : <code>[integer]</code></li>
<li><code>[timestamp]</code></li>
</ul>
</li>
<li><code>merTeploty2</code>
<ul>
<li><code>tag1</code> : <code>TG1</code></li>
<li><code>tag2</code> : <code>teplota</code></li>
<li><code>teplotaCelsia</code> : <code>[integer]</code></li>
<li><code>[timestamp]</code></li>
</ul>
</li>
<li><code>merTeploty3</code>
<ul>
<li><code>tag1</code> : <code>TG2</code></li>
<li><code>tag2</code> : <code>teplota</code></li>
<li><code>teplotaCelsia</code> : <code>[integer]</code></li>
<li><code>[timestamp]</code></li>
</ul>
</li>
<li><code>merTeploty4</code>
<ul>
<li><code>tag1</code> : <code>TG2</code></li>
<li><code>tag2</code> : <code>teplota</code></li>
<li><code>teplotaCelsia</code> : <code>[integer]</code></li>
<li><code>[timestamp]</code></li>
</ul>
</li>
</ul>
<hr>
<h2 id="33-dashboard-fis-bc-jeho-panely-a-upozornění">3.3. Dashboard FIS-Bc, jeho panely a upozornění</h2>
<p>Popis ukázkového dashboardu a jeho panelů a upozornění včetně nastavení a použitých Flux dotazů.</p>
<p>Panely dashboardu jsou rozděleny do čtyř řádků dle typu dat, která zobrazují. Rozložení panelů je následující:</p>
<ul>
<li>MVE
<ul>
<li>Celkový výkon</li>
<li>Průměrný výkon</li>
<li>Upozornění
<ul>
<li>Upozornění: Výkon</li>
<li>Upozornění: Hladina</li>
<li>Upozornění: Teplota</li>
</ul>
</li>
</ul>
</li>
<li>Aktuální stav TG1
<ul>
<li>Celkový výkon</li>
<li>Průměrný výkon</li>
</ul>
</li>
<li>Aktuální stav TG2
<ul>
<li>Celkový výkon</li>
<li>Průměrný výkon</li>
</ul>
</li>
<li>Dlouhodobý přehled
<ul>
<li>Celkový výkon</li>
<li>Průměrný výkon</li>
</ul>
</li>
</ul>
<h3 id="331-celkový-výkon">3.3.1. Celkový výkon</h3>
<p>Panel měřidlo, který zobrazuje celkový výkon elektrárny - tedy obou soustrojí. Zobrazuje součet aktuálního výkonu obou soustrojí v <code>kWh</code>. Stupnice měřidla je od <code>0 kWh</code> do <code>120 kWh</code> (minimální a maximální výkon, kterého je elektrárna schopna dosáhnout). Klesne-li výkon pod <code>20 kWh</code>, měřidlo zmodná, pokud je výkon přes <code>100 kWh</code>, pak měřidlo zčervená, jinak je zelené.</p>
<h4 id="3311-flux-dotaz">3.3.1.1. Flux dotaz</h4>
<p>Získá všechna data o výkonu za posledních <code>20</code> sekund.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: -20s)
  |&gt; filter(fn: (r) =&gt;
    r.tag2 == &quot;vykon&quot;
  )
</div></code></code></pre>
<h4 id="3312-transformace-dat">3.3.1.2. Transformace dat</h4>
<p>Grafana získaná data o výkonu jednotlivých generátorů sečte sloučením řádků tabulky se stejnou časovou značkou a z výsledné tabulky zobrazí nejaktuálnější záznam časové řady.</p>
<hr>
<h3 id="332-průměrný-výkon">3.3.2. Průměrný výkon</h3>
<p>Panel koláčový graf, který zobrazuje průměrný výkon soustrojí jako podíl na celku v <code>kWh</code>.</p>
<h4 id="3321-flux-dotaz">3.3.2.1. Flux dotaz</h4>
<p>Získá průměr všech dat o výkonu od pevného datumu a vypočítá jejich průměr.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: 2021-12-01T00:00:00Z)
  |&gt; filter(fn: (r) =&gt;
    r.tag2 == &quot;vykon&quot;
  )
  |&gt; mean()
</div></code></code></pre>
<hr>
<h3 id="333-kumulativní-výroba">3.3.3. Kumulativní výroba</h3>
<p>Panel stat zobrazuje kumulativní výrobu obou generátorů dohromady v <code>kWh</code>. Tedy kolik elektrické energie elektrárna vyrobila.</p>
<h4 id="3331-flux-dotaz">3.3.3.1. Flux dotaz</h4>
<p>Získá všechna data o výkonu od pevného datumu, agreguje je v <code>60</code> minutových intervalech a vypočítá průměr agregovaných dat.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: 2021-12-01T00:00:00Z)
  |&gt; filter(fn: (r) =&gt;
    r.tag2 == &quot;vykon&quot;
  )
  |&gt; aggregateWindow(every: 1h, fn: mean)
</div></code></code></pre>
<h4 id="3332-transformace-dat">3.3.3.2. Transformace dat</h4>
<p>Grafana pro získaná agregovaná data přidá sloupec se součtem dat z řádku a posléze sečte všechna data v součtovém sloupci.</p>
<hr>
<h3 id="334-upozornění">3.3.4. Upozornění</h3>
<p>Panel upozornění zobrazuje seznam aktivních upozorněních s počítadlem, indikujícím, jak dlouho je již upozornění aktivní. Upozornění se řadí dle času aktivace - tedy nejaktuálnější upozornění se zobrazí v seznamu první.</p>
<p>Smyslem upozornění je identifikovat neobvyklé nebo nebezpečné stavy elektrárny a informovat o nich obsluhu, aby mohla situaci investigovat a případně zakročit.</p>
<h4 id="3341-upozornění-výkon">3.3.4.1. Upozornění: Výkon</h4>
<p>Slouží k upozornění na stav elektrárny, kdy průměrný výkon alespoň jednoho generátoru za poslední hodinu klesne pod <code>10 kWh</code>.</p>
<h5 id="33411-flux-dotazy-pro-upozornění">3.3.4.1.1. Flux dotazy pro upozornění</h5>
<p>Dotazy získají data nad kterými bude vyhodnocováno splnění logické podmínky.</p>
<h6 id="334111-a">3.3.4.1.1.1. A</h6>
<p>Získá data o výkonu TG1 za poslední hodinu.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: -1h)
  |&gt; filter(fn: (r) =&gt;
    r._measurement == &quot;merVykonu1&quot;
  )
</div></code></code></pre>
<h6 id="334112-b">3.3.4.1.1.2. B</h6>
<p>Získá data o výkonu TG2 za poslední hodinu.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: -1h)
  |&gt; filter(fn: (r) =&gt;
    r._measurement == &quot;merVykonu2&quot;
  )
</div></code></code></pre>
<h6 id="334113-c">3.3.4.1.1.3. C</h6>
<p>Podmínka boolean. Vyhodnotí, zda průměr <code>A</code> nebo průměr <code>B</code> je méně než <code>10</code>.</p>
<pre><code><code><div>WHEN    avg()   of  A   IS BELOW    10
OR      avg()   of  B   IS BELOW    10
</div></code></code></pre>
<h5 id="33412-nastavení">3.3.4.1.2. Nastavení</h5>
<ul>
<li>Evaluace: K evaluaci podmínky C dochází každou <code>1</code> minutu a podmínka musí být splněna po dobu <code>5</code> minut, aby došlo k aktivaci upozornění.</li>
<li>Popis: Průměrný výkon jedné z turbín je již hodinu nižší než <code>10 kWh</code>.</li>
<li>Souhrn: Nízký výkon turbíny.</li>
</ul>
<hr>
<h4 id="3342-upozornění-hladina">3.3.4.2. Upozornění: Hladina</h4>
<p>Slouží k upozornění na stav elektrárny, kdy průměrná hladina reportovaná alespoň jednou sondou se vychýlí z rozmezí <code>-10</code> až <code>10</code> centimetrů.</p>
<h5 id="33421-flux-dotazy-pro-upozornění">3.3.4.2.1. Flux dotazy pro upozornění</h5>
<p>Dotazy získají data nad kterými bude vyhodnocováno splnění logické podmínky.</p>
<h6 id="334211-a">3.3.4.2.1.1. A</h6>
<p>Získá data ze všech hladinových sond za posledních <code>10</code> minut.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: -10m)
  |&gt; filter(fn: (r) =&gt;
    r.tag2 == &quot;hladina&quot;
  )
</div></code></code></pre>
<h6 id="334212-b">3.3.4.2.1.2. B</h6>
<p>Podmínka boolean. Vyhodnotí, zda průměr <code>A</code> je mimo rozmezí <code>-10</code> až <code>10</code> centimetrů.</p>
<pre><code><code><div>WHEN    avg()   of  A   IS OUTSIDE RANGE    -10 TO  10
</div></code></code></pre>
<h5 id="33422-nastavení">3.3.4.2.2. Nastavení</h5>
<ul>
<li>Evaluace: K evaluaci podmínky <code>C</code> dochází každou <code>1</code> minutu a podmínka musí být splněna po dobu <code>2</code> minut, aby došlo k aktivaci upozornění.</li>
<li>Popis: Průměrné hladina vody za posledních <code>10</code> minut, alespoň na jedné sondě, je mimo rozmezí <code>-10</code> až <code>10</code> centimetrů.</li>
<li>Souhrn: Hladina mimo rozmezí.</li>
</ul>
<hr>
<h4 id="3343-upozornění-teplota">3.3.4.3. Upozornění: Teplota</h4>
<p>Slouží k upozornění na stav elektrárny, kdy maximální nebo minimální průměrná hodinová teplota reportovaná alespoň jednou sondou se v předchozích <code>24</code> hodinách vychýlila z romezí <code>10</code> až <code>75</code> stupňů Celsia.</p>
<h5 id="33431-flux-dotazy-pro-upozornění">3.3.4.3.1. Flux dotazy pro upozornění</h5>
<p>Dotazy získají data nad kterými bude vyhodnocováno splnění logické podmínky.</p>
<h6 id="334311-a">3.3.4.3.1.1. A</h6>
<p>Získá data ze všech hladinových sond za posledních <code>10</code> minut.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: -1d)
  |&gt; filter(fn: (r) =&gt;
    r.tag2 == &quot;teplota&quot;
  )
  |&gt; aggregateWindow(every: 1h, fn: mean)
</div></code></code></pre>
<h6 id="334312-b">3.3.4.3.1.2. B</h6>
<p>Podmínka <code>boolean</code>. Vyhodnotí, zda maximun <code>A</code> je vyšší než <code>75</code> nebo minimum <code>A</code> je nižší než <code>10</code> stupňů Celsia.</p>
<pre><code><code><div>WHEN    max()   of  A   IS ABOVE    75
OR      min()   of  A   IS BELOW    10
</div></code></code></pre>
<h5 id="33432-nastavení">3.3.4.3.2. Nastavení</h5>
<ul>
<li>Evaluace: K evaluaci podmínky B dochází každých <code>30</code> minut a k aktivaci upozornění dochází okamžitě při jejím splnění.</li>
<li>Popis: Maximální nebo minimální průměrná hodinová teplota byla za posledních <code>24</code> hodin mimo bezpečné rozmezí.</li>
<li>Souhrn: Teplota na nebezpečné úrovni.</li>
</ul>
<hr>
<h3 id="335-výkon-tg1-a-výkon-tg2">3.3.5. Výkon TG1 a Výkon TG2</h3>
<p>Panel měřidlo, který zobrazuje výkon TG1 v <code>kWh</code>. Stupnice měřidla je od <code>0 kWh</code> do <code>60 kWh</code> (minimální a maximální výkon TG1). Klesne-li výkon pod <code>10 kWh</code>, měřidlo zmodná, pokud je výkon přes <code>50 kWh</code>, pak měřidlo zčervená, jinak je zelené. Měřidlo zobrazí nejaktuálnější záznam získané časové řady.</p>
<h4 id="3351-flux-dotaz-pro-výkon-tg1">3.3.5.1. Flux dotaz pro Výkon TG1</h4>
<p>Získá data o výkonu TG1 za posledních <code>20</code> sekund.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: -20s)
  |&gt; filter(fn: (r) =&gt;
    r.tag1 == &quot;TG1&quot; and
    r.tag2 == &quot;vykon&quot;
  )
</div></code></code></pre>
<h4 id="3352-flux-dotaz-pro-výkon-tg2">3.3.5.2. Flux dotaz pro Výkon TG2</h4>
<p>Získá data o výkonu TG2 za posledních <code>20</code> sekund.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: -20s)
  |&gt; filter(fn: (r) =&gt;
    r.tag1 == &quot;TG2&quot; and
    r.tag2 == &quot;vykon&quot;
  )
</div></code></code></pre>
<hr>
<h3 id="336-hladina-nad-tg1-a-hladina-nad-tg2">3.3.6. Hladina nad TG1 a Hladina nad TG2</h3>
<p>Panel sloupcová měrka, který zobrazuje aktuální hladinu vody nad soustrojím v <code>cm</code> jako odchylku od běžné hladiny, která je v datech reprezentována hodnotou <code>0</code> centimetrů. Rozmezí měrky je <code>-20</code> až <code>20</code> centimetrů. Pokud je hladina pod záporná, pak měrka zčervená, jinak je zelená.</p>
<h4 id="3361-flux-dotaz-pro-hladina-nad-tg1">3.3.6.1. Flux dotaz pro Hladina nad TG1</h4>
<p>Získá data o výšce hladiny nad TG1 za posledních <code>20</code> sekund.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: -20s)
  |&gt; filter(fn: (r) =&gt;
    r._measurement == &quot;merHladiny1&quot; and
    r.tag1 == &quot;TG1&quot; and
    r.tag2 == &quot;hladina&quot;
  )
</div></code></code></pre>
<h4 id="3362-flux-dotaz-pro-hladina-nad-tg2">3.3.6.2. Flux dotaz pro Hladina nad TG2</h4>
<p>Získá data o výšce hladiny nad TG2 za posledních <code>20</code> sekund.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: -20s)
  |&gt; filter(fn: (r) =&gt;
    r._measurement == &quot;merHladiny3&quot; and
    r.tag1 == &quot;TG2&quot; and
    r.tag2 == &quot;hladina&quot;
  )
</div></code></code></pre>
<hr>
<h3 id="337-hladina-pod-tg1-a-hladina-pod-tg2">3.3.7. Hladina pod TG1 a Hladina pod TG2</h3>
<p>Panel sloupcová měrka, který zobrazuje aktuální hladinu vody pod soustrojím. Analogicky, jako panely zobrazující hladinu nad soustrojím, má měrka rozmezí <code>-20</code> až <code>20</code> centimetrů - avšak logika zabarvení zelenou a červenou barvou je opačná, neboť pod soustrojím je žádoucí co nejnižší hladina.</p>
<h4 id="3371-flux-dotaz-pro-hladina-pod-tg1">3.3.7.1. Flux dotaz pro Hladina pod TG1</h4>
<p>Získá data o výšce hladiny pod TG1 za posledních <code>20</code> sekund.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: -20s)
  |&gt; filter(fn: (r) =&gt;
    r._measurement == &quot;merHladiny4&quot; and
    r.tag1 == &quot;TG1&quot; and
    r.tag2 == &quot;hladina&quot;
  )
</div></code></code></pre>
<h4 id="3372-flux-dotaz-pro-hladina-pod-tg2">3.3.7.2. Flux dotaz pro Hladina pod TG2</h4>
<p>Získá data o výšce hladiny pod TG2 za posledních <code>20</code> sekund.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: -20s)
  |&gt; filter(fn: (r) =&gt;
    r._measurement == &quot;merHladiny4 and
    r.tag1 == &quot;TG2&quot; and
    r.tag2 == &quot;hladina&quot;
  )
</div></code></code></pre>
<hr>
<h3 id="338-teplota-ložiska-generátoru-tg1-a-teplota-ložiska-generátoru-tg2">3.3.8. Teplota ložiska generátoru TG1 a Teplota ložiska generátoru TG2</h3>
<p>Panel sloupcová měrka, který zobrazuje aktuální teplotu ložiska příslušného generátoru ve stupních Celsia. Rozmezí měrky je <code>-5</code> až <code>90</code> stupňů a zabarvuje se v barevném gradientu <code>modrá-žlutá-červená</code>.</p>
<h4 id="3381-flux-dotaz-pro-teplota-ložiska-generátoru-tg1">3.3.8.1. Flux dotaz pro Teplota ložiska generátoru TG1</h4>
<p>Získá data o teplotě ložiska generátoru TG1 za posledních <code>20</code> sekund.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: -20s)
  |&gt; filter(fn: (r) =&gt;
    r._measurement == &quot;merTeploty1&quot; and
    r.tag1 == &quot;TG1&quot; and
    r.tag2 == &quot;teplota&quot;
  )
</div></code></code></pre>
<h4 id="3382-flux-dotaz-pro-teplota-ložiska-generátoru-tg2">3.3.8.2. Flux dotaz pro Teplota ložiska generátoru TG2</h4>
<p>Získá data o teplotě ložiska generátoru TG2 za posledních <code>20</code> sekund.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: -20s)
  |&gt; filter(fn: (r) =&gt;
    r._measurement == &quot;merTeploty3&quot; and
    r.tag1 == &quot;TG2&quot; and
    r.tag2 == &quot;teplota&quot;
  )
</div></code></code></pre>
<hr>
<h3 id="339-teplota-ložiska-turbíny-tg1-a-teplota-ložiska-turbíny-tg2">3.3.9. Teplota ložiska turbíny TG1 a Teplota ložiska turbíny TG2</h3>
<p>Panel sloupcová měrka, který zobrazuje aktuální teplotu ložiska příslušné turbíny ve stupních Celsia. Rozmezí měrky je <code>-5</code> až <code>90</code> stupňů a zabarvuje se v barevném gradientu <code>modrá-žlutá-červená</code>.</p>
<h4 id="3391-flux-dotaz-pro-teplota-ložiska-generátoru-tg1">3.3.9.1. Flux dotaz pro Teplota ložiska generátoru TG1</h4>
<p>Získá data o teplotě ložiska turbíny TG1 za posledních <code>20</code> sekund.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: -20s)
  |&gt; filter(fn: (r) =&gt;
    r._measurement == &quot;merTeploty2&quot; and
    r.tag1 == &quot;TG1&quot; and
    r.tag2 == &quot;teplota&quot;
  )
</div></code></code></pre>
<h4 id="3392-flux-dotaz-pro-teplota-ložiska-generátoru-tg2">3.3.9.2. Flux dotaz pro Teplota ložiska generátoru TG2</h4>
<p>Získá data o teplotě ložiska turbíny TG2 za posledních <code>20</code> sekund.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: -20s)
  |&gt; filter(fn: (r) =&gt;
    r._measurement == &quot;merTeploty4&quot; and
    r.tag1 == &quot;TG2&quot; and
    r.tag2 == &quot;teplota&quot;
  )
</div></code></code></pre>
<hr>
<h3 id="3310-výkon">3.3.10. Výkon</h3>
<p>Panel časová řada, který zobrazuje výkon jednotlivých generátorů a součet jejich výkonů v liniovém grafu. Na ose <code>X</code> je čas a na ose <code>Y</code> výkon v <code>kWh</code>. V grafu jsou tedy vykresleny tři linie.</p>
<h4 id="33101-flux-dotaz-pro-výkon">3.3.10.1. Flux dotaz pro Výkon</h4>
<p>Získá všechna data o výkonu od pevného datumu.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: 2021-12-01T00:00:00Z)
  |&gt; filter(fn: (r) =&gt;
    r.tag2 == &quot;vykon&quot;
  )
</div></code></code></pre>
<h4 id="33102-transformace-dat">3.3.10.2. Transformace dat</h4>
<p>Grafana k získaným datům o výkonu jednotlivých generátorů přidá sloupec se součtem dat z řádku. Takto vzniklý součtový sloupec pak vykreslí do grafu jako samostatnou linii představující součet výkonů generátorů v daný moment.</p>
<hr>
<h3 id="3311-výkon">3.3.11. Výkon</h3>
<p>Panel časová řada, který zobrazuje výkon jednotlivých generátorů a součet jejich výkonů v liniovém grafu. Na ose <code>X</code> je čas a na ose <code>Y</code> výkon v <code>kWh</code>. V grafu jsou tedy vykresleny tři linie.</p>
<h4 id="33111-flux-dotaz-pro-výkon">3.3.11.1. Flux dotaz pro Výkon</h4>
<p>Získá všechna data o výkonu od pevného datumu.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: 2021-12-01T00:00:00Z)
  |&gt; filter(fn: (r) =&gt;
    r.tag2 == &quot;vykon&quot;
  )
</div></code></code></pre>
<h4 id="33112-transformace-dat">3.3.11.2. Transformace dat</h4>
<p>Grafana k získaným datům o výkonu jednotlivých generátorů přidá sloupec se součtem dat z řádku. Takto vzniklý součtový sloupec pak vykreslí do grafu jako samostatnou linii představující součet výkonů generátorů v daný moment.</p>
<hr>
<h3 id="3312-hladina">3.3.12. Hladina</h3>
<p>Panel časová řada, který zobrazuje výšku hladiny reportovanou hladinovými sondami v liniovém grafu. Na ose <code>X</code> je čas a na ose <code>Y</code> výška hladiny v <code>cm</code>. V grafu jsou tedy vykresleny čtyři linie, z nichž každá reprezentuje data z jedné hladinové sondy.</p>
<h4 id="33121-flux-dotaz-pro-hladina">3.3.12.1. Flux dotaz pro Hladina</h4>
<p>Získá všechna data o hladinách od pevného datumu.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: 2021-01-01T00:00:00Z)
  |&gt; filter(fn: (r) =&gt;
    r.tag2 == &quot;hladina&quot;
  )
</div></code></code></pre>
<hr>
<h3 id="3313-průměrná-hladina-nad-mve">3.3.13. Průměrná hladina nad MVE</h3>
<p>Panel stat zobrazuje průměrnou výšku hladiny nad oběma soustrojími v <code>cm</code>. Pokud je průměrná hladina méně než <code>0</code> centimetrů, pak je panel červený, jinak je zelený.</p>
<h4 id="33131-flux-dotaz-pro-průměrná-hladina-nad-mve">3.3.13.1. Flux dotaz pro Průměrná hladina nad MVE</h4>
<p>Získá všechna data o hladinách nad oběma soustrojími od pevného datumu.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: 2021-01-01T00:00:00Z)
  |&gt; filter(fn: (r) =&gt;
    r._measurement == &quot;merHladiny1&quot; or
    r._measurement == &quot;merHladiny3&quot;
  )
</div></code></code></pre>
<h4 id="33132-transformace-dat">3.3.13.2. Transformace dat</h4>
<p>Grafana nejdříve sloučí řádky tabulky se stejnou časovou značkou a zprůměruje jejich hodnotu. Poté získá průměr všech výsledných řádků, který zobrazí jako výsledek.</p>
<hr>
<h3 id="3314-průměrná-hladina-pod-mve">3.3.14. Průměrná hladina pod MVE</h3>
<p>Panel stat zobrazuje průměrnou výšku hladiny pod oběma soustrojími v <code>cm</code>. Pokud je průměrná hladina méně než <code>0</code> centimetrů, pak je panel zelený, jinak je červený. Tedy opak logiky panelu Průměrná hladina nad MVE, neboť pod soustrojími se preferuje záporná hladina.</p>
<h4 id="33141-flux-dotaz-pro-průměrná-hladina-pod-mve">3.3.14.1. Flux dotaz pro Průměrná hladina pod MVE</h4>
<p>Získá všechna data o hladinách pod oběma soustrojími od pevného datumu.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: 2021-01-01T00:00:00Z)
  |&gt; filter(fn: (r) =&gt;
    r._measurement == &quot;merHladiny2&quot; or
    r._measurement == &quot;merHladiny4&quot;
  )
</div></code></code></pre>
<h4 id="33142-transformace-dat">3.3.14.2. Transformace dat</h4>
<p>Grafana nejdříve sloučí řádky tabulky se stejnou časovou značkou a zprůměruje jejich hodnotu. Poté získá průměr všech výsledných řádků, který zobrazí jako výsledek.</p>
<hr>
<h3 id="3315-teplota-ložisek">3.3.15. Teplota ložisek</h3>
<p>Panel časová řada, který zobrazuje teplotu ložisek generátorů a turbín v liniovém grafu. Na ose <code>X</code> je čas a na ose <code>Y</code> teplota ve stupních Celsia. V grafu jsou tedy vykresleny čtyři linie, z nichž každá reprezentuje data z jedné teplotní sondy.</p>
<h4 id="33151-flux-dotaz-pro-teplota-ložisek">3.3.15.1. Flux dotaz pro Teplota ložisek</h4>
<p>Získá všechna data o teplotách ložisek od pevného datumu.</p>
<pre><code class="language-Flux"><code><div>from(bucket:&quot;mve&quot;)
  |&gt; range(start: 2021-12-01T00:00:00Z)
  |&gt; filter(fn: (r) =&gt;
    r.tag2 == &quot;teplota&quot;
  )
</div></code></code></pre>
<hr>

    </body>
    </html>